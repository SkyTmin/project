<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#7B4B2A">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <title>Coco Instrument - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16.png">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/auth.css">
    <link rel="stylesheet" href="/css/coco-money.css">
</head>
<body>
    <div class="app-container">
        <nav id="main-nav" class="nav hidden">
            <div class="nav-brand">Coco Instrument</div>
            <div class="nav-links">
                <a href="#/home" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="#/coco-money" class="nav-link">Coco Money</a>
            </div>
            <div class="nav-user">
                <span id="user-email"></span>
                <button id="logout-btn" class="btn-logout">–í—ã—Ö–æ–¥</button>
            </div>
        </nav>

        <div class="module-container">
            <div id="auth-module" class="module hidden">
                <div class="auth-container">
                    <h1 class="auth-title">Coco Instrument</h1>
                    
                    <form id="login-form" class="auth-form">
                        <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                        <input type="email" name="login-email" placeholder="Email" required>
                        <input type="password" name="login-password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                        <label class="remember-device">
                            <input type="checkbox" name="remember-device">
                            <span>–ó–∞–ø–æ–º–Ω–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</span>
                        </label>
                        <button type="submit" class="btn-primary">–í–æ–π—Ç–∏</button>
                        <div class="auth-switch">
                            –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" id="show-register">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                        </div>
                    </form>
                    
                    <form id="register-form" class="auth-form hidden">
                        <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                        <input type="email" name="register-email" placeholder="Email" required>
                        <input type="password" name="register-password" placeholder="–ü–∞—Ä–æ–ª—å" required minlength="6">
                        <input type="date" name="register-date" placeholder="–î–∞—Ç–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏" required>
                        <div class="date-hint">–í–≤–µ–¥–∏—Ç–µ –≤—á–µ—Ä–∞—à–Ω—é—é –¥–∞—Ç—É –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
                        <button type="submit" class="btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                        <div class="auth-switch">
                            –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" id="show-login">–í–æ–π—Ç–∏</a>
                        </div>
                    </form>
                </div>
            </div>

            <div id="home-module" class="module hidden">
                <div class="home-container">
                    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Coco Instrument</h1>
                    <p class="home-description">–ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞—à–∏–º–∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏</p>
                    
                    <div class="search-container">
                        <input type="text" id="tool-search" class="search-input" placeholder="–ü–æ–∏—Å–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤...">
                        <span class="search-icon">üîç</span>
                    </div>
                    
                    <div id="tools-grid" class="tools-grid">
                        <a href="#/coco-money" class="tool-card" data-tool-name="Coco Money" data-tool-desc="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞–º–∏ –∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏">
                            <div class="tool-icon">üí∞</div>
                            <h3>Coco Money</h3>
                            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–∞–º–∏ –∏ —Ä–∞—Å—Ö–æ–¥–∞–º–∏</p>
                        </a>
                    </div>
                    
                    <div id="no-results" class="no-results hidden">
                        <p>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    </div>
                </div>
            </div>

            <div id="coco-money-module" class="module hidden">
                <div class="coco-money-container">
                    <div class="balance-header">
                        <h2>Coco Money</h2>
                        <div class="balance-info">
                            <span class="balance-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</span>
                            <span id="total-balance" class="balance-amount">0 —Ä—É–±.</span>
                        </div>
                    </div>
                    
                    <div id="empty-state" class="empty-state hidden">
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ª–∏—Å—Ç–æ–≤ –¥–æ—Ö–æ–¥–æ–≤</p>
                        <button id="create-first-sheet" class="btn-primary">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ª–∏—Å—Ç</button>
                    </div>
                    
                    <div id="sheets-container" class="sheets-container">
                        <div class="sheets-section">
                            <h3>–õ–∏—Å—Ç—ã –¥–æ—Ö–æ–¥–æ–≤</h3>
                            <div id="regular-sheets" class="sheets-grid"></div>
                        </div>
                        <div class="sheets-section">
                            <h3>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ—Ö–æ–¥—ã</h3>
                            <div id="preliminary-sheets" class="sheets-grid"></div>
                        </div>
                    </div>
                    
                    <div id="statistics-section" class="statistics-section">
                        <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">üìä</div>
                                <div class="stat-info">
                                    <div class="stat-label">–õ–∏—Å—Ç–æ–≤ –¥–æ—Ö–æ–¥–æ–≤</div>
                                    <div id="stat-total-sheets" class="stat-value">0</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">üíµ</div>
                                <div class="stat-info">
                                    <div class="stat-label">–û–±—â–∏–π –¥–æ—Ö–æ–¥</div>
                                    <div id="stat-total-income" class="stat-value">0 —Ä—É–±.</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">üí∏</div>
                                <div class="stat-info">
                                    <div class="stat-label">–û–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã</div>
                                    <div id="stat-total-expenses" class="stat-value">0 —Ä—É–±.</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">üìà</div>
                                <div class="stat-info">
                                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥</div>
                                    <div id="stat-avg-expense" class="stat-value">0 —Ä—É–±.</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon">‚è≥</div>
                                <div class="stat-info">
                                    <div class="stat-label">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ</div>
                                    <div id="stat-preliminary" class="stat-value">0 —Ä—É–±.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button id="fab-add-sheet" class="fab">+</button>
            </div>
        </div>
    </div>

    <div id="sheet-fullscreen" class="sheet-fullscreen hidden">
        <div class="sheet-fullscreen-header">
            <button id="btn-back" class="btn-back">‚Üê</button>
            <h2 id="fullscreen-sheet-title" class="sheet-fullscreen-title"></h2>
        </div>
        
        <div class="sheet-fullscreen-content">
            <div id="sheet-info" class="sheet-info">
                <div class="sheet-header">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏—Å—Ç–µ</h3>
                    <div class="sheet-actions">
                        <button id="edit-sheet-btn" class="btn-icon" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                        <button id="export-sheet-btn" class="btn-icon" title="–≠–∫—Å–ø–æ—Ä—Ç">üì•</button>
                    </div>
                </div>
                <div class="sheet-details">
                    <div class="detail-item">
                        <span>–î–æ—Ö–æ–¥</span>
                        <span id="sheet-income">0 —Ä—É–±.</span>
                    </div>
                    <div class="detail-item">
                        <span>–†–∞—Å—Ö–æ–¥—ã</span>
                        <span id="sheet-expenses">0 —Ä—É–±.</span>
                    </div>
                    <div class="detail-item">
                        <span>–û—Å—Ç–∞—Ç–æ–∫</span>
                        <span id="sheet-balance">0 —Ä—É–±.</span>
                    </div>
                </div>
            </div>
            
            <form id="sheet-edit-form" class="sheet-edit-form hidden">
                <input type="text" id="edit-sheet-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞" required>
                <input type="number" id="edit-sheet-income" placeholder="–î–æ—Ö–æ–¥" required min="0" step="0.01">
                <input type="date" id="edit-sheet-date" required>
                <label class="checkbox-label">
                    <input type="checkbox" id="edit-sheet-preliminary">
                    <span>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥</span>
                </label>
                <label class="checkbox-label">
                    <input type="checkbox" id="edit-sheet-exclude">
                    <span>–ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –æ–±—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞</span>
                </label>
                <div class="form-actions">
                    <button type="button" id="save-sheet-btn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" id="cancel-edit-btn" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                    <button type="button" id="delete-sheet-btn" class="btn-danger">–£–¥–∞–ª–∏—Ç—å –ª–∏—Å—Ç</button>
                </div>
            </form>
            
            <div class="expenses-section">
                <h4>–†–∞—Å—Ö–æ–¥—ã</h4>
                
                <div class="expenses-tabs">
                    <button id="tab-regular" class="expense-tab active">–û–±—ã—á–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã</button>
                    <button id="tab-preliminary" class="expense-tab">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ</button>
                </div>
                
                <div id="regular-expenses" class="expense-content">
                    <form id="add-expense-form" class="expense-form">
                        <input type="number" name="expense-amount" placeholder="–°—É–º–º–∞" required min="0.01" step="0.01">
                        <input type="text" name="expense-note" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                        <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </form>
                    <div id="expenses-list" class="expenses-list"></div>
                </div>
                
                <div id="preliminary-expenses" class="expense-content hidden">
                    <form id="add-preliminary-form" class="expense-form">
                        <input type="number" name="preliminary-amount" placeholder="–°—É–º–º–∞" required min="0.01" step="0.01">
                        <input type="text" name="preliminary-note" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                        <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </form>
                    <div id="preliminary-list" class="expenses-list"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="new-sheet-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–ù–æ–≤—ã–π –ª–∏—Å—Ç –¥–æ—Ö–æ–¥–æ–≤</h3>
            <form id="new-sheet-form">
                <input type="text" name="new-sheet-name" id="new-sheet-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
                <input type="number" name="new-sheet-income" id="new-sheet-income" placeholder="–î–æ—Ö–æ–¥" required min="0" step="0.01">
                <input type="date" name="new-sheet-date" id="new-sheet-date" required>
                <label class="checkbox-label">
                    <input type="checkbox" name="new-sheet-preliminary" id="new-sheet-preliminary">
                    <span>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥</span>
                </label>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                    <button type="button" id="cancel-new-sheet" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <div id="expense-edit-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥</h3>
            <form id="expense-edit-form">
                <input type="hidden" name="edit-expense-id" id="edit-expense-id">
                <input type="number" name="edit-expense-amount" id="edit-expense-amount" placeholder="–°—É–º–º–∞" required min="0.01" step="0.01">
                <input type="text" name="edit-expense-note" id="edit-expense-note" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                <label class="checkbox-label">
                    <input type="checkbox" name="edit-expense-preliminary" id="edit-expense-preliminary">
                    <span>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—Ö–æ–¥</span>
                </label>
                <div class="form-actions">
                    <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" id="cancel-expense-edit" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <div id="confirm-modal" class="modal hidden">
        <div class="modal-content">
            <h3 id="confirm-title"></h3>
            <p id="confirm-message"></p>
            <div class="form-actions">
                <button id="confirm-yes" class="btn-primary">–î–∞</button>
                <button id="confirm-no" class="btn-secondary">–ù–µ—Ç</button>
            </div>
        </div>
    </div>

    <div id="export-modal" class="modal hidden">
        <div class="modal-content">
            <h3>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
            <div id="export-preview" class="export-preview"></div>
            <div class="form-actions">
                <button id="copy-export" class="btn-primary">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                <button id="download-export" class="btn-primary">–°–∫–∞—á–∞—Ç—å</button>
                <button id="close-export" class="btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="loader" class="loader hidden">
        <div class="spinner"></div>
    </div>

    <div id="toast-container" class="toast-container"></div>

    <script src="/js/core/EventBus.js"></script>
    <script src="/js/core/StateManager.js"></script>
    <script src="/js/core/APIClient.js"></script>
    <script src="/js/core/Router.js"></script>
    <script src="/js/core/ModuleManager.js"></script>
    <script src="/js/modules/AuthModule.js"></script>
    <script src="/js/modules/HomeModule.js"></script>
    <script src="/js/modules/CocoMoneyModule.js"></script>
    <script src="/js/app.js"></script>
</body>
</html>
